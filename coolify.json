{
  "services": {
    "postgres": {
      "image": "postgres:16-alpine",
      "environment": {
        "POSTGRES_USER": "postgres",
        "POSTGRES_PASSWORD": "${DB_PASSWORD}",
        "POSTGRES_DB": "fluidesk"
      },
      "volumes": ["postgres_data:/var/lib/postgresql/data"],
      "ports": ["5432:5432"]
    },
    "api": {
      "build": {
        "context": ".",
        "dockerfile": "Dockerfile"
      },
      "command": "npm run start:prod --workspace=api",
      "environment": {
        "DATABASE_URL": "postgresql://postgres:${DB_PASSWORD}@postgres:5432/fluidesk",
        "JWT_SECRET": "${JWT_SECRET}",
        "JWT_REFRESH_SECRET": "${JWT_REFRESH_SECRET}",
        "PORT": "3001",
        "NODE_ENV": "production"
      },
      "ports": ["3001:3001"],
      "depends_on": ["postgres"]
    },
    "web": {
      "build": {
        "context": ".",
        "dockerfile": "Dockerfile"
      },
      "command": "npm run start --workspace=web",
      "environment": {
        "NEXT_PUBLIC_API_URL": "https://api.fluidesk.fluintech.com/api/v1",
        "NODE_ENV": "production"
      },
      "ports": ["3000:3000"],
      "depends_on": ["api"]
    }
  },
  "volumes": {
    "postgres_data": null
  }
}
